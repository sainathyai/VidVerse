{
    "family":  "vidverse-backend",
    "networkMode":  "awsvpc",
    "requiresCompatibilities":  [
                                    "FARGATE"
                                ],
    "cpu":  "512",
    "memory":  "1024",
    "executionRoleArn":  "arn:aws:iam::971422717446:role/ecsTaskExecutionRole",
    "taskRoleArn":  "arn:aws:iam::971422717446:role/EcsTaskRole",
    "containerDefinitions":  [
                                 {
                                     "name":  "backend",
                                     "image":  "971422717446.dkr.ecr.us-west-2.amazonaws.com/vidverse-backend:latest",
                                     "essential":  true,
                                     "portMappings":  [
                                                          {
                                                              "containerPort":  3001,
                                                              "protocol":  "tcp"
                                                          }
                                                      ],
                                     "environment":  [
                                                         {
                                                             "name":  "NODE_ENV",
                                                             "value":  "production"
                                                         },
                                                         {
                                                             "name":  "PORT",
                                                             "value":  "3001"
                                                         },
                                                         {
                                                             "value":  "./certs/rds-ca-rsa2048-g1.pem",
                                                             "name":  "DATABASE_SSL_CA_PATH"
                                                         },
                                                         {
                                                             "value":  "true",
                                                             "name":  "DATABASE_SSL"
                                                         },
                                                         {
                                                             "value":  "true",
                                                             "name":  "DATABASE_SSL_REJECT_UNAUTHORIZED"
                                                         },
                                                         {
                                                             "value":  "https://vidverseai.com",
                                                             "name":  "FRONTEND_URL"
                                                         },
                                                         {
                                                             "value":  "https://vidverseai.com",
                                                             "name":  "ALLOWED_ORIGINS"
                                                         },
                                                         {
                                                             "value":  "https://api.vidverseai.com",
                                                             "name":  "BACKEND_URL"
                                                         }
                                                     ],
                                     "secrets":  [
                                                     {
                                                         "name":  "DATABASE_URL",
                                                         "valueFrom":  "arn:aws:secretsmanager:us-west-2:971422717446:secret:vidverse/database-url"
                                                     },
                                                     {
                                                         "name":  "COGNITO_USER_POOL_ID",
                                                         "valueFrom":  "arn:aws:secretsmanager:us-west-2:971422717446:secret:vidverse/cognito-user-pool-id"
                                                     },
                                                     {
                                                         "name":  "COGNITO_CLIENT_ID",
                                                         "valueFrom":  "arn:aws:secretsmanager:us-west-2:971422717446:secret:vidverse/cognito-client-id"
                                                     },
                                                     {
                                                         "name":  "S3_ACCESS_KEY_ID",
                                                         "valueFrom":  "arn:aws:secretsmanager:us-west-2:971422717446:secret:vidverse/s3-access-key-id"
                                                     },
                                                     {
                                                         "name":  "S3_SECRET_ACCESS_KEY",
                                                         "valueFrom":  "arn:aws:secretsmanager:us-west-2:971422717446:secret:vidverse/s3-secret-access-key"
                                                     },
                                                     {
                                                         "name":  "REPLICATE_API_TOKEN",
                                                         "valueFrom":  "arn:aws:secretsmanager:us-west-2:971422717446:secret:vidverse/replicate-api-token"
                                                     },
                                                     {
                                                         "name":  "OPENROUTER_API_KEY",
                                                         "valueFrom":  "arn:aws:secretsmanager:us-west-2:971422717446:secret:vidverse/openrouter-api-key"
                                                     }
                                                 ],
                                     "logConfiguration":  {
                                                              "logDriver":  "awslogs",
                                                              "options":  {
                                                                              "awslogs-group":  "/ecs/vidverse-backend",
                                                                              "awslogs-region":  "us-west-2",
                                                                              "awslogs-stream-prefix":  "ecs"
                                                                          }
                                                          },
                                     "healthCheck":  {
                                                         "command":  [
                                                                         "CMD-SHELL",
                                                                         "node -e \"require(\u0027http\u0027).get(\u0027http://localhost:3001/health\u0027, (r) =\u003e {process.exit(r.statusCode === 200 ? 0 : 1)})\""
                                                                     ],
                                                         "interval":  30,
                                                         "timeout":  5,
                                                         "retries":  3,
                                                         "startPeriod":  60
                                                     }
                                 }
                             ]
}
